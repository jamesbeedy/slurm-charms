base: ubuntu@22.04

applications:
  mysql:
    charm: mysql
    channel: 8.0/stable
    num_units: 1

  slurmctld:
    charm: ./../_build/slurmctld.charm
    num_units: 1
    options:
      user-provided-slurm-path-prefix: /srv/slurm/view
    constraints: virt-type=virtual-machine cores=4 mem=4G root-disk=20G

  slurmd:
    charm: ./../_build/slurmd.charm
    num_units: 2
    options:
      user-provided-slurm-path-prefix: /srv/slurm/view
    constraints: virt-type=virtual-machine cores=4 mem=4G root-disk=20G

  slurmdbd:
    charm: ./../_build/slurmdbd.charm
    num_units: 1

  slurmrestd:
    charm: ./../_build/slurmrestd.charm
    num_units: 1

relations:
- - slurmdbd:database
  - mysql:database
- - slurmctld:slurmd
  - slurmd:slurmctld
- - slurmctld:slurmdbd
  - slurmdbd:slurmctld
- - slurmctld:slurmrestd
  - slurmrestd:slurmctld
